<button class="button is-dark has-background-black-ter has-text-primary mt-3" (click)="displayModal = true">
  Add schedule
</button>
<div class="modal" [ngClass]="{'is-active': displayModal}">
  <div class="modal-background"></div>
  <div class="modal-card">
    <form [formGroup]="scheduleForm">
      <header class="modal-card-head has-background-grey-darker">
        <p class="modal-card-title has-text-white-ter">Add schedule</p>
        <button (click)="displayModal = false" class="delete" aria-label="close"></button>
      </header>
      <section class="modal-card-body has-background-grey-dark">
        <div class="steps">
          <div *ngFor="let step of steps; let index=index"
            [ngClass]="{'is-completed': currentStep>index, 'is-active': index==currentStep || currentStep>index}"
            class="step-item">
            <div class="step-marker"><i class="{{step.icon}}"></i></div>
            <div class="step-details">
              <p class="step-title" [ngClass]="{'has-text-primary': index==currentStep}">{{step.title}}</p>
            </div>
          </div>
          <div class="steps-content">
            <!-- Select script -->
            <div class="step-content has-text-centered is-active">
              <div *ngIf="currentStep === 0">
                <div class="field">
                  <label class="label has-text-white-ter">Select script which will be executed: </label>
                  <div class="select">
                    <select formControlName="scriptName" required>
                      <option *ngFor="let script of selectedProject.scripts | keyvalue" [ngValue]="script.key">
                        {{script.key}}</option>
                    </select>
                  </div>
                </div>
              </div>

              <!-- Then select time with until option -->
              <div *ngIf="currentStep === 1">
                <div formGroupName="every">
                  <label class="label has-text-white-ter mt-5">Set schedule time: </label>
                  <div class="field is-horizontal">
                    <input class="input" type="number" min=0 max=60 placeholder="Run script every x hours/minutes"
                      name="value" formControlName="value" required>
                    <div class="select">
                      <select name="timeType" formControlName="timeType">
                        <option *ngFor="let timeValue of timeValuesArray" [ngValue]="timeValue">
                          {{ timeValue }}
                        </option>
                      </select>
                    </div>
                  </div>
                </div>
                <div class="field mt-5">
                  <label class="label has-text-white-ter">Set how many times script should run and exit: </label>
                  <input class="input" type="number" min=0 max=100 placeholder="Run script x times" name="exitAfter"
                    formControlName="exitAfter" required>
                </div>
              </div>
              <!-- Confirm new schedule -->
              <div *ngIf="currentStep === 2">
                <h1 class="is-size-4">This is a summary of new schedule: </h1>
                <p class="mt-5">Script "{{scheduleForm.controls['scriptName'].value}}" will run every
                  {{scheduleForm.controls['every'].value.value}} {{scheduleForm.controls['every'].value.timeType}}
                </p>
                <div *ngIf="scheduleForm.controls['exitAfter'].value>0">
                  And after {{scheduleForm.controls['exitAfter'].value}} script executions, schedule will be deleted
                </div>
                <button (click)="onSubmit()" class="button is-dark has-text-primary mt-5">Add Schedule</button>
              </div>
            </div>
          </div>
          <div class="steps-actions">
            <div class="steps-action">
              <button (click)="currentStep = currentStep-1" data-nav="previous" [disabled]="currentStep === 0"
                class="button is-dark">Previous</button>
            </div>
            <div class="steps-action">
              <button (click)="currentStep = currentStep+1" data-nav="next" [disabled]="currentStep === 2 ||
              (currentStep === 0 && !scheduleForm.controls['scriptName'].valid) ||
              (currentStep === 1 && !scheduleForm.controls['every'].valid)" class="button is-dark">Next</button>
            </div>
          </div>
        </div>
      </section>
    </form>
  </div>
</div>
